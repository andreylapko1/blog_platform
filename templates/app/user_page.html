{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile {{ user.username }}</title>
    <link rel="stylesheet" href="{% static 'css/app/user_page.css' %}">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="site-wrapper">
        <header class="main-header">
            <div class="container">
                <h1>Community Blog</h1>
                <nav>
                    <a href="{% url 'home_view' %}">Home</a>
                    {% if user.is_authenticated %}
                    <a href="{% url 'post_create_view' %}">Create Post</a>
                    <a href="{% url 'user_page_view' %}">Profile</a>
                    <a href="{% url 'account_logout' %}">Logout</a>
                    {% endif %}
                </nav>
            </div>
        </header>

        <main class="user-profile-main">
                {% if messages %}
        <ul class="messages">
            {% for message in messages %}
                <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>
                    {{ message }}
                </li>
            {% endfor %}
        </ul>
    {% endif %}
            <div class="container">
                <section class="profile-card">
                {% if user.profile.profile_image %}
                    <img src="{{ user.profile.profile_image.url }}" alt="{{ user.username }}" class="author-avatar">
                {% else %}
                    <img src="{% static 'img/default_avatar.png' %}" alt="Default Avatar" class="author-avatar">
                {% endif %}
                <div class="profile-info">
                    <h2 class="profile-username">{{ user.username }}</h2>
                    <p class="profile-email">{{ user.email }}</p>
                    {% if user.is_authenticated and user == request.user %}
                    <a href="{%  url 'user_detail' %}" class="edit-profile-btn">Edit Profile</a>
                    {% endif %}
                </div>
            </div>
                   <div class="profile-bio">
    <h3>About Me</h3>
    {% if user.userinformation %}
        {% if user.userinformation.about_user %}
            <p>{{ user.userinformation.about_user }}</p>
        {% else %}
            <p class="no-bio-message">User has not added a description yet.</p>
        {% endif %}
        <h4>Contact & Details</h4>
        <ul>
            {% if user.userinformation.phone %}
                <li><strong>Phone:</strong> {{ user.userinformation.phone }}</li>
            {% endif %}
            {% if user.userinformation.inst %}
                <li><strong>Instagram:</strong> <a href="{{ user.userinformation.inst }}">{{ user.userinformation.inst }}</a></li>
            {% endif %}
            {% if user.userinformation.web_site %}
                <li><strong>Website:</strong> <a href="{{ user.userinformation.web_site }}">{{ user.userinformation.web_site }}</a></li>
            {% endif %}
            {% if user.userinformation.geo %}
                <li><strong>Location:</strong> {{ user.userinformation.geo }}</li>
            {% endif %}
            {% if user.userinformation.profession %}
                <li><strong>Profession:</strong> {{ user.userinformation.get_profession_display }}</li>
            {% endif %}
            {% if user.userinformation.hobbies %}
                <li><strong>Hobbies:</strong> {{ user.userinformation.hobbies }}</li>
            {% endif %}
            {% if user.userinformation.date_of_birth %}
                <li><strong>Date of Birth:</strong> {{ user.userinformation.date_of_birth|date:"F d, Y" }}</li>
            {% endif %}
            {% if user.userinformation.years %}
                <li><strong>Years:</strong> {{ user.userinformation.years}}</li>
            {% endif %}
        </ul>

    {% else %}
        <p class="no-bio-message">User has not added any personal information yet.</p>
    {% endif %}
</div>
                </section>

                <section class="user-posts-section">
                    <h3>User Posts</h3>
                    {% if user.posts.all %}
                        <div class="post-grid">
                            {% for post in user.posts.all %}
                                <article class="post-card">
                                    <div class="post-header">
                                        <img src="{{ user.profile.profile_image.url }}" alt="{{ user.username }}" class="author-avatar">
                                        <div class="author-info">
                                            <span class="author-name">{{ user.username }}</span>
                                            <time datetime="{{ post.created_at|date:'c' }}" class="post-date">{{ post.created_at|date:"d M Y" }}</time>
                                        </div>
                                    </div>
                                    <h2 class="post-title"><a href="#">{{ post.title }}</a></h2>
                                    <p class="post-excerpt">{{ post.content|truncatechars:150 }}</p>
                                    <a href="{%  url 'post_detail_view' post.pk %}" class="read-more">Читать далее &rarr;</a>
                                    {% if user.is_authenticated and user == request.user %}
                                    <a href="{%  url 'post_update_view' post.pk %}" class="read-more">Редактировать &rarr;</a>
                                    <form action="{% url 'post_delete_view' post.pk %}" method="post" style="display:inline;">
                                            {% csrf_token %}
                                            <button type="submit" class="read-more" onclick="return confirm('Вы уверены, что хотите удалить этот пост?');">
                                                Удалить
                                            </button>
                                        </form>
                                    {% endif %}

                                </article>
                            {% endfor %}
                        </div>
                    {% else %}
                        <p class="no-posts-message">This user has no posts yet.</p>
                    {% endif %}
                </section>
            </div>
        </main>
    </div>


    <footer class="main-footer">
        <div class="container">
            <p>&copy; 2025 Community Blog. All rights reserved.</p>
        </div>
    </footer>
</body>
</html>